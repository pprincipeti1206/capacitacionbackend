<?xml version="1.0" encoding="UTF-8"?>
<!--
 ! Project home: https://github.com/jaxio/celerio-angular-quickstart
 ! 
 ! Source code generated by Celerio, an Open Source code generator by Jaxio.
 ! Documentation: http://www.jaxio.com/documentation/celerio/
 ! Modificado por CARLOS BAZALAR
 ! Email: cbazalarlarosa@gmail.com
 ! Template pack-angular:src/main/java/mapper/EntityXMLMapper.xml.e.vm
-->

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.incloud.hcp.mapper.FacFacturaMapper">

    <resultMap id="facFacturaResultMap" type="com.incloud.hcp.domain.FacFactura">
        <id property="id" jdbcType="INTEGER" column="fac_factura_id"/>
        <result property="serieFactura" jdbcType="VARCHAR" column="serie_factura"/>
        <result property="numeroFactura" jdbcType="VARCHAR" column="numero_factura"/>
        <result property="mtrEstado.id" jdbcType="INTEGER" column="mtr_estado_id"/>
        <result property="mtrProveedor.id" jdbcType="INTEGER" column="mtr_proveedor_id"/>
        <result property="mtrMoneda.id" jdbcType="INTEGER" column="mtr_moneda_id"/>
        <result property="mtrDetraccion.id" jdbcType="INTEGER" column="mtr_detraccion_id"/>
        <result property="tipoFactura" jdbcType="VARCHAR" column="tipo_factura"/>
        <result property="tipoComprobanteFactura" jdbcType="VARCHAR" column="tipo_comprobante_factura"/>
        <result property="monto" jdbcType="NUMERIC" column="monto"/>
        <result property="montoOtrosCargos" jdbcType="NUMERIC" column="monto_otros_cargos"/>
        <result property="montoIgv" jdbcType="NUMERIC" column="monto_igv"/>
        <result property="montoFinal" jdbcType="NUMERIC" column="monto_final"/>
        <result property="glosa" jdbcType="VARCHAR" column="glosa"/>
        <result property="fechaFactura" jdbcType="TIMESTAMP" column="fecha_factura"/>
        <result property="fechaEmision" jdbcType="TIMESTAMP" column="fecha_emision"/>
        <result property="fechaCreacion" jdbcType="TIMESTAMP" column="fecha_creacion"/>
        <result property="existeContrato" jdbcType="VARCHAR" column="existe_contrato"/>
        <result property="estadoRetornoSunat" jdbcType="VARCHAR" column="estado_retorno_sunat"/>
        <result property="detalleServicio" jdbcType="VARCHAR" column="detalle_servicio"/>
        <result property="indicadorConCertificado" jdbcType="VARCHAR" column="indicador_con_certificado"/>
        <result property="concepto" jdbcType="VARCHAR" column="concepto"/>
        <result property="codigoCorrelativoAdjunto" jdbcType="VARCHAR" column="codigo_correlativo_adjunto"/>
        <result property="estado" jdbcType="VARCHAR" column="estado"/>
        <result property="mtrSociedad.id" jdbcType="INTEGER" column="mtr_sociedad_id"/>
        <result property="fechaEstimadaPago" jdbcType="TIMESTAMP" column="fecha_estimada_pago"/>
        <result property="fechaPago" jdbcType="TIMESTAMP" column="fecha_pago"/>
        <result property="fechaAprobacion" jdbcType="TIMESTAMP" column="fecha_aprobacion"/>
        <result property="nroIteracion" jdbcType="INTEGER" column="nro_iteracion"/>
        <result property="fechaPosibleVencimiento" jdbcType="TIMESTAMP" column="fecha_posible_vencimiento"/>
        <result property="indAprobacionRechazoFinal" jdbcType="VARCHAR" column="ind_aprobacion_rechazo_final"/>
    </resultMap>
    <resultMap id="preRegistroItemMap" type="com.incloud.hcp.bean.custom.PreRegistroItemBean">
        <id property="cerCertificadoDetalleId" jdbcType="INTEGER" column="cer_certificado_detalle_id"/>
        <result property="codigoNotaPedidoSap" jdbcType="VARCHAR" column="codigo_nota_pedido_sap"/>
        <result property="posicionSap" jdbcType="VARCHAR" column="posicion_sap"/>
        <result property="introw" jdbcType="VARCHAR" column="introw"/>
        <result property="tipo" jdbcType="VARCHAR" column="tipo"/>
        <result property="unidadMedidaId" jdbcType="INTEGER" column="mtr_unidad_medida_id"/>
        <result property="unidadTextoItem" jdbcType="VARCHAR" column="unidad_texto_item"/>
        <result property="cantidadAprobada" jdbcType="INTEGER" column="cantidad_aprobada"/>
        <result property="precioUnitario" jdbcType="INTEGER" column="precio_unitario"/>
        <result property="codigoCertificado" jdbcType="VARCHAR" column="codigo_certificado"/>
        <result property="notaPedidoDetalleId" jdbcType="INTEGER" column="cer_nota_pedido_detalle_id"/>
        <result property="cerCertificadoId" jdbcType="INTEGER" column="cer_certificado_id"/>
        <result property="hes" jdbcType="VARCHAR" column="documento_generado"/>
		<result property="hesMaterial" jdbcType="VARCHAR" column="documento_generadoMaterial"/>
        <result property="idPadre" jdbcType="INTEGER" column="id_padre"/>

    </resultMap>

    <select id="getLista" parameterType="com.incloud.hcp.domain.FacFactura" resultMap="facFacturaResultMap">
        SELECT
        fac_factura_id ,
        serie_factura ,
        numero_factura ,
        mtr_estado_id ,
        mtr_proveedor_id ,
        mtr_moneda_id ,
        mtr_detraccion_id ,
        tipo_factura ,
        tipo_comprobante_factura ,
        monto ,
        monto_otros_cargos ,
        monto_igv ,
        monto_final ,
        glosa ,
        fecha_factura ,
        fecha_emision ,
        fecha_creacion ,
        existe_contrato ,
        estado_retorno_sunat ,
        detalle_servicio ,
        indicador_con_certificado ,
        concepto ,
        codigo_correlativo_adjunto ,
        estado ,
        mtr_sociedad_id ,
        fecha_estimada_pago ,
        fecha_pago ,
        fecha_aprobacion ,
        nro_iteracion ,
        fecha_posible_vencimiento ,
        ind_aprobacion_rechazo_final
        FROM
        fac_factura
        WHERE 1 = 1
        <if test="id != null ">
            AND fac_factura_id = #{id, jdbcType=INTEGER}
        </if>
        <if test="serieFactura != null and serieFactura != '' ">
            AND serie_factura = #{serieFactura}
        </if>
        <if test="numeroFactura != null and numeroFactura != '' ">
            AND numero_factura = #{numeroFactura}
        </if>
        <if test="mtrEstado != null and mtrEstado.id != null">
            AND mtr_estado_id = #{mtrEstado.id, jdbcType=INTEGER}
        </if>
        <if test="mtrProveedor != null and mtrProveedor.id != null">
            AND mtr_proveedor_id = #{mtrProveedor.id, jdbcType=INTEGER}
        </if>
        <if test="mtrMoneda != null and mtrMoneda.id != null">
            AND mtr_moneda_id = #{mtrMoneda.id, jdbcType=INTEGER}
        </if>
        <if test="mtrDetraccion != null and mtrDetraccion.id != null">
            AND mtr_detraccion_id = #{mtrDetraccion.id, jdbcType=INTEGER}
        </if>
        <if test="tipoFactura != null and tipoFactura != '' ">
            AND tipo_factura = #{tipoFactura}
        </if>
        <if test="tipoComprobanteFactura != null and tipoComprobanteFactura != '' ">
            AND tipo_comprobante_factura = #{tipoComprobanteFactura}
        </if>
        <if test="monto != null ">
            AND monto = #{monto, jdbcType=NUMERIC}
        </if>
        <if test="montoOtrosCargos != null ">
            AND monto_otros_cargos = #{montoOtrosCargos, jdbcType=NUMERIC}
        </if>
        <if test="montoIgv != null ">
            AND monto_igv = #{montoIgv, jdbcType=NUMERIC}
        </if>
        <if test="montoFinal != null ">
            AND monto_final = #{montoFinal, jdbcType=NUMERIC}
        </if>
        <if test="glosa != null and glosa != '' ">
            AND glosa = #{glosa}
        </if>
        <if test="fechaFactura != null ">
            AND fecha_factura = #{fechaFactura, jdbcType=DATE}
        </if>
        <if test="fechaEmision != null ">
            AND fecha_emision = #{fechaEmision, jdbcType=DATE}
        </if>
        <if test="fechaCreacion != null ">
            AND fecha_creacion = #{fechaCreacion, jdbcType=DATE}
        </if>
        <if test="existeContrato != null and existeContrato != '' ">
            AND existe_contrato = #{existeContrato}
        </if>
        <if test="estadoRetornoSunat != null and estadoRetornoSunat != '' ">
            AND estado_retorno_sunat = #{estadoRetornoSunat}
        </if>
        <if test="detalleServicio != null and detalleServicio != '' ">
            AND detalle_servicio = #{detalleServicio}
        </if>
        <if test="indicadorConCertificado != null and indicadorConCertificado != '' ">
            AND indicador_con_certificado = #{indicadorConCertificado}
        </if>
        <if test="concepto != null and concepto != '' ">
            AND concepto = #{concepto}
        </if>
        <if test="codigoCorrelativoAdjunto != null and codigoCorrelativoAdjunto != '' ">
            AND codigo_correlativo_adjunto = #{codigoCorrelativoAdjunto}
        </if>
        <if test="estado != null and estado != '' ">
            AND estado = #{estado}
        </if>
        <if test="mtrSociedad != null and mtrSociedad.id != null">
            AND mtr_sociedad_id = #{mtrSociedad.id, jdbcType=INTEGER}
        </if>
        <if test="fechaEstimadaPago != null ">
            AND fecha_estimada_pago = #{fechaEstimadaPago, jdbcType=DATE}
        </if>
        <if test="fechaPago != null ">
            AND fecha_pago = #{fechaPago, jdbcType=DATE}
        </if>
        <if test="fechaAprobacion != null ">
            AND fecha_aprobacion = #{fechaAprobacion, jdbcType=DATE}
        </if>
        <if test="nroIteracion != null ">
            AND nro_iteracion = #{nroIteracion, jdbcType=INTEGER}
        </if>
        <if test="fechaPosibleVencimiento != null ">
            AND fecha_posible_vencimiento = #{fechaPosibleVencimiento, jdbcType=DATE}
        </if>
        <if test="indAprobacionRechazoFinal != null and indAprobacionRechazoFinal != '' ">
            AND ind_aprobacion_rechazo_final = #{indAprobacionRechazoFinal}
        </if>
    </select>

    <select id="listaItemPreRegistro" parameterType="com.incloud.hcp.bean.custom.PreRegistroItemBean"
            resultMap="preRegistroItemMap">

        /*select
        e.codigo_nota_pedido_sap,
        b.posicion_sap,
        b.introw,
        e.tipo,
        b.mtr_unidad_medida_id,
        b.unidad_texto_item,
        a.cantidad_aprobada,
        a.precio_unitario,
        b.cer_nota_pedido_detalle_id,
        a.cer_certificado_id,
        c.codigo_certificado,
        a.cer_certificado_detalle_id,
        (select x.documento_generado
        from cer_certificado_detalle_sap x inner join cer_certificado_detalle y
        on x.cer_certificado_detalle_id = y.cer_certificado_detalle_id inner join cer_certificado z on
        y.cer_certificado_id = z.cer_certificado_id
        where z.cer_certificado_id = a.cer_certificado_id and x.posicion_sap = b.posicion_sap
        and ( x.documento_generado is not null and length(x.documento_generado) > 0 )
        ) as documento_generado,
        ( CASE WHEN (e.tipo = 'M')
        THEN

        (
        select x.documento_generado
        from cer_certificado_detalle_sap x inner join cer_certificado_detalle y
        on x.cer_certificado_detalle_id = y.cer_certificado_detalle_id inner join cer_certificado z on
        y.cer_certificado_id = z.cer_certificado_id inner join  cer_nota_pedido w on
        z.cer_nota_pedido_id = w.cer_nota_pedido_id
        where z.cer_certificado_id = a.cer_certificado_id and w.tipo = 'M'
        and ( x.documento_generado is not null and length(x.documento_generado) > 0 )

        )

        ELSE

        (
        NULL

        )

        END ) as documento_generadoMaterial

        from cer_certificado_detalle a inner join cer_nota_pedido_detalle b
        on a.cer_nota_pedido_detalle_id = b.cer_nota_pedido_detalle_id inner join cer_certificado c on
        a.cer_certificado_id = c.cer_certificado_id inner join fac_factura_certificado d on
        c.cer_certificado_id = d.cer_certificado_id inner join cer_nota_pedido e on
        b.cer_nota_pedido_id = e.cer_nota_pedido_id
        where 1 = 1
        order by a.cer_certificado_id, a.cer_certificado_detalle_id, documento_generado*/

        select
        e.codigo_nota_pedido_sap,
        b.posicion_sap,
        b.introw,
        b.extrow,
        e.tipo,
        b.mtr_unidad_medida_id,
        b.unidad_texto_item,
        a.cantidad_aprobada,
        a.precio_unitario,
        b.cer_nota_pedido_detalle_id,
        a.cer_certificado_id,
        c.codigo_certificado,
        a.cer_certificado_detalle_id,
        ''  as documento_generado,
        '' as documento_generadoMaterial,
        b.id_padre
        from cer_certificado_detalle a inner join cer_nota_pedido_detalle b
        on a.cer_nota_pedido_detalle_id = b.cer_nota_pedido_detalle_id inner join cer_certificado c on
        a.cer_certificado_id = c.cer_certificado_id inner join fac_factura_certificado d on
        c.cer_certificado_id = d.cer_certificado_id inner join cer_nota_pedido e on
        b.cer_nota_pedido_id = e.cer_nota_pedido_id
        where 1 = 1
        <if test="idFactura != null ">
            and d.fac_factura_id = #{idFactura, jdbcType=INTEGER}
        </if>
        order by a.cer_certificado_id, a.cer_certificado_detalle_id, documento_generado

    </select>

    <insert id="insertBean">
INSERT INTO  fac_factura(
fac_factura_id , 
serie_factura , 
numero_factura , 
mtr_estado_id , 
mtr_proveedor_id , 
mtr_moneda_id , 
mtr_detraccion_id , 
tipo_factura , 
tipo_comprobante_factura , 
monto , 
monto_otros_cargos , 
monto_igv , 
monto_final , 
glosa , 
fecha_factura , 
fecha_emision , 
fecha_creacion , 
existe_contrato , 
estado_retorno_sunat , 
detalle_servicio , 
indicador_con_certificado , 
concepto , 
codigo_correlativo_adjunto , 
estado , 
mtr_sociedad_id , 
fecha_estimada_pago , 
fecha_pago , 
fecha_aprobacion , 
nro_iteracion , 
fecha_posible_vencimiento , 
ind_aprobacion_rechazo_final 
)
VALUES
(
#{id} , 
#{serieFactura} , 
#{numeroFactura} , 
#{mtrEstado.id} , 
#{mtrProveedor.id} , 
#{mtrMoneda.id} , 
#{mtrDetraccion.id} , 
#{tipoFactura} , 
#{tipoComprobanteFactura} , 
#{monto} , 
#{montoOtrosCargos} , 
#{montoIgv} , 
#{montoFinal} , 
#{glosa} , 
#{fechaFactura} , 
#{fechaEmision} , 
#{fechaCreacion} , 
#{existeContrato} , 
#{estadoRetornoSunat} , 
#{detalleServicio} , 
#{indicadorConCertificado} , 
#{concepto} , 
#{codigoCorrelativoAdjunto} , 
#{estado} , 
#{mtrSociedad.id} , 
#{fechaEstimadaPago} , 
#{fechaPago} , 
#{fechaAprobacion} , 
#{nroIteracion} , 
#{fechaPosibleVencimiento} , 
#{indAprobacionRechazoFinal} 
)

</insert>

    <insert id="insertMap" parameterType="java.util.Map">
        INSERT INTO fac_factura(
        fac_factura_id ,
        serie_factura ,
        numero_factura ,
        mtr_estado_id ,
        mtr_proveedor_id ,
        mtr_moneda_id ,
        mtr_detraccion_id ,
        tipo_factura ,
        tipo_comprobante_factura ,
        monto ,
        monto_otros_cargos ,
        monto_igv ,
        monto_final ,
        glosa ,
        fecha_factura ,
        fecha_emision ,
        fecha_creacion ,
        existe_contrato ,
        estado_retorno_sunat ,
        detalle_servicio ,
        indicador_con_certificado ,
        concepto ,
        codigo_correlativo_adjunto ,
        estado ,
        mtr_sociedad_id ,
        fecha_estimada_pago ,
        fecha_pago ,
        fecha_aprobacion ,
        nro_iteracion ,
        fecha_posible_vencimiento ,
        ind_aprobacion_rechazo_final
        )
        (
        <foreach collection="list" item="element" index="index" separator=" UNION ">
            SELECT
            #{element.id} ,
            #{element.serieFactura} ,
            #{element.numeroFactura} ,
            #{element.mtrEstado.id} ,
            #{element.mtrProveedor.id} ,
            #{element.mtrMoneda.id} ,
            #{element.mtrDetraccion.id} ,
            #{element.tipoFactura} ,
            #{element.tipoComprobanteFactura} ,
            #{element.monto} ,
            #{element.montoOtrosCargos} ,
            #{element.montoIgv} ,
            #{element.montoFinal} ,
            #{element.glosa} ,
            #{element.fechaFactura} ,
            #{element.fechaEmision} ,
            #{element.fechaCreacion} ,
            #{element.existeContrato} ,
            #{element.estadoRetornoSunat} ,
            #{element.detalleServicio} ,
            #{element.indicadorConCertificado} ,
            #{element.concepto} ,
            #{element.codigoCorrelativoAdjunto} ,
            #{element.estado} ,
            #{element.mtrSociedad.id} ,
            #{element.fechaEstimadaPago} ,
            #{element.fechaPago} ,
            #{element.fechaAprobacion} ,
            #{element.nroIteracion} ,
            #{element.fechaPosibleVencimiento} ,
            #{element.indAprobacionRechazoFinal}
            from dual

        </foreach>
        )

    </insert>

    <select id="eliminarFacturaPorId" statementType="CALLABLE">
        { CALL SP_DELETE_FACTURA(
        #{idFactura}
        )}
    </select>


    <update id="updateBean">
        UPDATE fac_factura
        <set>
            <if test="serieFactura != null and serieFactura != '' ">
                serie_factura = #{serieFactura},
            </if>
            <if test="numeroFactura != null and numeroFactura != '' ">
                numero_factura = #{numeroFactura},
            </if>
            <if test="mtrEstadoId != null ">
                mtr_estado_id = #{mtrEstado.id, jdbcType=INTEGER},
            </if>
            <if test="mtrProveedorId != null ">
                mtr_proveedor_id = #{mtrProveedor.id, jdbcType=INTEGER},
            </if>
            <if test="mtrMonedaId != null ">
                mtr_moneda_id = #{mtrMoneda.id, jdbcType=INTEGER},
            </if>
            <if test="mtrDetraccionId != null ">
                mtr_detraccion_id = #{mtrDetraccion.id, jdbcType=INTEGER},
            </if>
            <if test="tipoFactura != null and tipoFactura != '' ">
                tipo_factura = #{tipoFactura},
            </if>
            <if test="tipoComprobanteFactura != null and tipoComprobanteFactura != '' ">
                tipo_comprobante_factura = #{tipoComprobanteFactura},
            </if>
            <if test="monto != null ">
                monto = #{monto, jdbcType=NUMERIC},
            </if>
            <if test="montoOtrosCargos != null ">
                monto_otros_cargos = #{montoOtrosCargos, jdbcType=NUMERIC},
            </if>
            <if test="montoIgv != null ">
                monto_igv = #{montoIgv, jdbcType=NUMERIC},
            </if>
            <if test="montoFinal != null ">
                monto_final = #{montoFinal, jdbcType=NUMERIC},
            </if>
            <if test="glosa != null and glosa != '' ">
                glosa = #{glosa},
            </if>
            <if test="fechaFactura != null ">
                fecha_factura = #{fechaFactura, jdbcType=DATE},
            </if>
            <if test="fechaEmision != null ">
                fecha_emision = #{fechaEmision, jdbcType=DATE},
            </if>
            <if test="fechaCreacion != null ">
                fecha_creacion = #{fechaCreacion, jdbcType=DATE},
            </if>
            <if test="existeContrato != null and existeContrato != '' ">
                existe_contrato = #{existeContrato},
            </if>
            <if test="estadoRetornoSunat != null and estadoRetornoSunat != '' ">
                estado_retorno_sunat = #{estadoRetornoSunat},
            </if>
            <if test="detalleServicio != null and detalleServicio != '' ">
                detalle_servicio = #{detalleServicio},
            </if>
            <if test="indicadorConCertificado != null and indicadorConCertificado != '' ">
                indicador_con_certificado = #{indicadorConCertificado},
            </if>
            <if test="concepto != null and concepto != '' ">
                concepto = #{concepto},
            </if>
            <if test="codigoCorrelativoAdjunto != null and codigoCorrelativoAdjunto != '' ">
                codigo_correlativo_adjunto = #{codigoCorrelativoAdjunto},
            </if>
            <if test="estado != null and estado != '' ">
                estado = #{estado},
            </if>
            <if test="mtrSociedadId != null ">
                mtr_sociedad_id = #{mtrSociedad.id, jdbcType=INTEGER},
            </if>
            <if test="fechaEstimadaPago != null ">
                fecha_estimada_pago = #{fechaEstimadaPago, jdbcType=DATE},
            </if>
            <if test="fechaPago != null ">
                fecha_pago = #{fechaPago, jdbcType=DATE},
            </if>
            <if test="fechaAprobacion != null ">
                fecha_aprobacion = #{fechaAprobacion, jdbcType=DATE},
            </if>
            <if test="nroIteracion != null ">
                nro_iteracion = #{nroIteracion, jdbcType=INTEGER},
            </if>
            <if test="fechaPosibleVencimiento != null ">
                fecha_posible_vencimiento = #{fechaPosibleVencimiento, jdbcType=DATE},
            </if>
            <if test="indAprobacionRechazoFinal != null and indAprobacionRechazoFinal != '' ">
                ind_aprobacion_rechazo_final = #{indAprobacionRechazoFinal},
            </if>
        </set>
        WHERE
        fac_factura_id = #{id, jdbcType=INTEGER}
    </update>


    <delete id="deleteBean">
        DELETE FROM fac_factura
        WHERE 1 = 1
        <if test="id != null ">
            AND fac_factura_id = #{id, jdbcType=INTEGER}
        </if>
        <if test="serieFactura != null and serieFactura != '' ">
            AND serie_factura = #{serieFactura}
        </if>
        <if test="numeroFactura != null and numeroFactura != '' ">
            AND numero_factura = #{numeroFactura}
        </if>
        <if test="mtrEstado != null and mtrEstado.id != null">
            AND mtr_estado_id = #{mtrEstado.id}
        </if>
        <if test="mtrProveedor != null and mtrProveedor.id != null">
            AND mtr_proveedor_id = #{mtrProveedor.id}
        </if>
        <if test="mtrMoneda != null and mtrMoneda.id != null">
            AND mtr_moneda_id = #{mtrMoneda.id}
        </if>
        <if test="mtrDetraccion != null and mtrDetraccion.id != null">
            AND mtr_detraccion_id = #{mtrDetraccion.id}
        </if>
        <if test="tipoFactura != null and tipoFactura != '' ">
            AND tipo_factura = #{tipoFactura}
        </if>
        <if test="tipoComprobanteFactura != null and tipoComprobanteFactura != '' ">
            AND tipo_comprobante_factura = #{tipoComprobanteFactura}
        </if>
        <if test="monto != null ">
            AND monto = #{monto, jdbcType=NUMERIC}
        </if>
        <if test="montoOtrosCargos != null ">
            AND monto_otros_cargos = #{montoOtrosCargos, jdbcType=NUMERIC}
        </if>
        <if test="montoIgv != null ">
            AND monto_igv = #{montoIgv, jdbcType=NUMERIC}
        </if>
        <if test="montoFinal != null ">
            AND monto_final = #{montoFinal, jdbcType=NUMERIC}
        </if>
        <if test="glosa != null and glosa != '' ">
            AND glosa = #{glosa}
        </if>
        <if test="fechaFactura != null ">
            AND fecha_factura = #{fechaFactura, jdbcType=DATE}
        </if>
        <if test="fechaEmision != null ">
            AND fecha_emision = #{fechaEmision, jdbcType=DATE}
        </if>
        <if test="fechaCreacion != null ">
            AND fecha_creacion = #{fechaCreacion, jdbcType=DATE}
        </if>
        <if test="existeContrato != null and existeContrato != '' ">
            AND existe_contrato = #{existeContrato}
        </if>
        <if test="estadoRetornoSunat != null and estadoRetornoSunat != '' ">
            AND estado_retorno_sunat = #{estadoRetornoSunat}
        </if>
        <if test="detalleServicio != null and detalleServicio != '' ">
            AND detalle_servicio = #{detalleServicio}
        </if>
        <if test="indicadorConCertificado != null and indicadorConCertificado != '' ">
            AND indicador_con_certificado = #{indicadorConCertificado}
        </if>
        <if test="concepto != null and concepto != '' ">
            AND concepto = #{concepto}
        </if>
        <if test="codigoCorrelativoAdjunto != null and codigoCorrelativoAdjunto != '' ">
            AND codigo_correlativo_adjunto = #{codigoCorrelativoAdjunto}
        </if>
        <if test="estado != null and estado != '' ">
            AND estado = #{estado}
        </if>
        <if test="mtrSociedad != null and mtrSociedad.id != null">
            AND mtr_sociedad_id = #{mtrSociedad.id}
        </if>
        <if test="fechaEstimadaPago != null ">
            AND fecha_estimada_pago = #{fechaEstimadaPago, jdbcType=DATE}
        </if>
        <if test="fechaPago != null ">
            AND fecha_pago = #{fechaPago, jdbcType=DATE}
        </if>
        <if test="fechaAprobacion != null ">
            AND fecha_aprobacion = #{fechaAprobacion, jdbcType=DATE}
        </if>
        <if test="nroIteracion != null ">
            AND nro_iteracion = #{nroIteracion, jdbcType=INTEGER}
        </if>
        <if test="fechaPosibleVencimiento != null ">
            AND fecha_posible_vencimiento = #{fechaPosibleVencimiento, jdbcType=DATE}
        </if>
        <if test="indAprobacionRechazoFinal != null and indAprobacionRechazoFinal != '' ">
            AND ind_aprobacion_rechazo_final = #{indAprobacionRechazoFinal}
        </if>
    </delete>

    <delete id="deleteAll">
   DELETE FROM fac_factura
</delete>

</mapper>